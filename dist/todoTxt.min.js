/*! todoTxtWebUi v1.0.0, created by: Jason Holt Smith <bicarbon8@gmail.com> 2015-01-06 17:18:04 */

[].includes||(Array.prototype.includes=function(a){"use strict";if(void 0===this||null===this)throw new TypeError("Cannot convert this value to object");var b=Object(this),c=parseInt(b.length)||0;if(0===c)return!1;var d,e=parseInt(arguments[1])||0;e>=0?d=e:(d=c+e,0>d&&(d=0));for(var f;c>d;){if(f=b[d],a===f||a!==a&&f!==f)return!0;d++}return!1});var TodoTxt={namespace:"TodoTxt.",Attributes:{priorities:{},projects:{},contexts:{}},getSortedTaskArray:function(){var a=[],b=new RegExp("^("+(new TodoTxt.Task).namespace+")");TodoTxt._clearAttributes();for(var c in localStorage)if(c.match(b)){var d=TodoTxt.getTask(c);d&&(d.id=c,a.push(d),TodoTxt._updateAttributes(d))}return a.sort(TodoTxt._compareTasks),a},getFilteredTaskArray:function(a){var b=TodoTxt.getSortedTaskArray();if(a&&""!==a){for(var c=a.split(" "),d=".*",e=0;e<c.length;e++){var f=c[e].replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08");d+="("+f+").*"}var g=new RegExp(d,"i"),h=b.filter(function(a){return a.toString().match(g)});b=h}return b},getTask:function(a){var b,c=localStorage.getItem(a);return null!==c&&void 0!==c&&(b=new TodoTxt.Task(c),b.id=a),b},addTask:function(a){localStorage.setItem(a.id,a.toString()),TodoTxt._updateAttributes(a)},parseTodoTxtFile:function(a,b){b||TodoTxt.deleteAllTasks();var c=a.split("\n");for(var d in c)if("string"==typeof c[d]){var e=c[d];if(e&&""!==e){var f=new TodoTxt.Task(e);TodoTxt.addTask(f)}}},createTask:function(a){var b=a||"",c=new TodoTxt.Task(a);TodoTxt.updateTask(c.id,b)},updateTask:function(a,b){var c=new TodoTxt.Task(b);return c.id=a,TodoTxt.addTask(c),!0},deleteTask:function(a){return localStorage.removeItem(a),!0},deleteAllTasks:function(){var a=new RegExp("^("+(new TodoTxt.Task).namespace+")");for(var b in localStorage)b.match(a)&&TodoTxt.deleteTask(b)},_updateAttributes:function(a){a.priority&&(TodoTxt.Attributes.priorities[a.priority]=!0);for(var b in a.projects)"string"==typeof a.projects[b]&&(TodoTxt.Attributes.projects[a.projects[b]]=!0);for(var c in a.contexts)"string"==typeof a.contexts[c]&&(TodoTxt.Attributes.contexts[a.contexts[c]]=!0)},_clearAttributes:function(){TodoTxt.Attributes.priorities={},TodoTxt.Attributes.projects={},TodoTxt.Attributes.contexts={}},_compareTasks:function(a,b){var c=a.isActive,d=b.isActive,e=a.priority,f=b.priority,g=a.createdDate,h=b.createdDate,i=a.completedDate,j=b.completedDate;if(c!==d)return c?-1:1;if(e!==f){if(!f||f>e)return-1;if(!e||e>f)return 1}else{if(g!==h)return h>g?-1:1;if(i!==j)return i>j?-1:1}return 0}},TodoTxt=TodoTxt||{};TodoTxt.Utils={formatDate:function(a){var b=a.getFullYear(),c=a.getMonth()+1,d=a.getDate();return String(1e4*b+100*c+d)},getLanguage:function(){var a=window.navigator.userLanguage||window.navigator.language;return a.toLowerCase()},guid:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}};var TodoTxt=TodoTxt||{};TodoTxt.Task=function(a){this.namespace=TodoTxt.namespace+"Task.",this.id=this.namespace+TodoTxt.Utils.guid(),this.priority=null,this.createdDate=null,this.completedDate=null,this.projects=[],this.contexts=[],this.metadatas=[],this.isActive=!0,this.text="",a&&this._parseFromString(a)},TodoTxt.Task.prototype._parseFromString=function(a){if("string"!=typeof a)throw"cannot parse input of type: "+typeof a+". only strings are accepted.";this.text=a,this._parseStatusFromString(a),this._parsePriorityFromString(a),this._parseCompletedDateFromString(a),this._parseCreatedDateFromString(a),this._parseProjectsFromString(a),this._parseContextsFromString(a)},TodoTxt.Task.prototype._parseStatusFromString=function(a){this.isActive=a&&a.match(/^(x )/)?!1:!0},TodoTxt.Task.prototype._parsePriorityFromString=function(a){var b=null;if(a){var c=/^(\([A-Z]\) )/,d=a.match(c);d&&(b=d[0].replace(/[\s]*/g,""))}this.priority=b},TodoTxt.Task.prototype._parseCompletedDateFromString=function(a){var b=null;if(a&&!this.isActive){var c=this._parseDatesFromString(a);c&&(b=c[0].replace(/[\s]*/g,""))}this.completedDate=b},TodoTxt.Task.prototype._parseCreatedDateFromString=function(a){var b=null;if(a){var c=this._parseDatesFromString(a);c&&(this.isActive?b=c[0].replace(/[\s]*/g,""):c.length>1&&(b=c[1].replace(/[\s]*/g,"")))}this.createdDate=b},TodoTxt.Task.prototype._parseDatesFromString=function(a){var b=null;if(a){var c=/(\d{4}-\d{2}-\d{2}\s)/g;match=a.match(c),match&&(b=match)}return b},TodoTxt.Task.prototype._parseProjectsFromString=function(a){var b=[];if(a){var c=/(( |^)\+[0-9A-Za-z]+)/g,d=a.match(c);d&&(b=d.map(function(a){return a.replace(/[\s]*/g,"")}))}this.projects=b},TodoTxt.Task.prototype._parseContextsFromString=function(a){var b=[];if(a){var c=/(( |^)\@[0-9A-Za-z]+)/g,d=a.match(c);d&&(b=d.map(function(a){return a.replace(/[\s]*/g,"")}))}this.contexts=b},TodoTxt.Task.prototype.toString=function(){return this.text};
//# sourceMappingURL=todoTxt.min.js.map